import{r as ve,a as Ze,T as ht,w as ze,e as dt,g as ft}from"./enableAriaDecalForTree.d076ad27.js";import{bw as pt,aS as Ue,_ as he,q as G,d as Fe,h as gt,bx as _e,b2 as qe,by as ct,y as mt,M as le,m as yt,v as wt,e as Y,ai as bt,w as xt,a as V,i as F,aX as Ie,G as j,a_ as _t,bz as $e,bA as It,P as Tt,aF as St,b0 as Te,bB as Q,ac as Ke,t as Mt,a6 as se,bC as Dt,br as At,bD as Ct,af as $,bE as Se,bF as Rt,bG as Vt,C as Ht,bm as Je,z as Me,bH as Lt,bI as De,b3 as U,bJ as Ae,bK as Ce,j as Et,k as kt,bL as Wt,bM as Pt,a7 as Gt,aT as je,aU as Ot,a$ as Nt,L as Re,bb as Bt,bl as Xt,bN as Ve}from"./index.esm.min.5835493e.js";import{V as Yt}from"./install.e198c68a.js";var He="\0_ec_interaction_mutex";function Le(r,a){return!!Zt(r)[a]}function Zt(r){return r[He]||(r[He]={})}pt({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},Ue);var zt=function(r){he(a,r);function a(e){var t=r.call(this)||this;t._zr=e;var i=G(t._mousedownHandler,t),o=G(t._mousemoveHandler,t),n=G(t._mouseupHandler,t),l=G(t._mousewheelHandler,t),u=G(t._pinchHandler,t);return t.enable=function(s,v){this.disable(),this._opt=Fe(gt(v)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),s==null&&(s=!0),(s===!0||s==="move"||s==="pan")&&(e.on("mousedown",i),e.on("mousemove",o),e.on("mouseup",n)),(s===!0||s==="scale"||s==="zoom")&&(e.on("mousewheel",l),e.on("pinch",u))},t.disable=function(){e.off("mousedown",i),e.off("mousemove",o),e.off("mouseup",n),e.off("mousewheel",l),e.off("pinch",u)},t}return a.prototype.isDragging=function(){return this._dragging},a.prototype.isPinching=function(){return this._pinching},a.prototype.setPointerChecker=function(e){this.pointerChecker=e},a.prototype.dispose=function(){this.disable()},a.prototype._mousedownHandler=function(e){if(!_e(e)){for(var t=e.target;t;){if(t.draggable)return;t=t.__hostTarget||t.parent}var i=e.offsetX,o=e.offsetY;this.pointerChecker&&this.pointerChecker(e,i,o)&&(this._x=i,this._y=o,this._dragging=!0)}},a.prototype._mousemoveHandler=function(e){if(!(!this._dragging||!q("moveOnMouseMove",e,this._opt)||e.gestureEvent==="pinch"||Le(this._zr,"globalPan"))){var t=e.offsetX,i=e.offsetY,o=this._x,n=this._y,l=t-o,u=i-n;this._x=t,this._y=i,this._opt.preventDefaultMouseMove&&qe(e.event),Qe(this,"pan","moveOnMouseMove",e,{dx:l,dy:u,oldX:o,oldY:n,newX:t,newY:i,isAvailableBehavior:null})}},a.prototype._mouseupHandler=function(e){_e(e)||(this._dragging=!1)},a.prototype._mousewheelHandler=function(e){var t=q("zoomOnMouseWheel",e,this._opt),i=q("moveOnMouseWheel",e,this._opt),o=e.wheelDelta,n=Math.abs(o),l=e.offsetX,u=e.offsetY;if(!(o===0||!t&&!i)){if(t){var s=n>3?1.4:n>1?1.2:1.1,v=o>0?s:1/s;re(this,"zoom","zoomOnMouseWheel",e,{scale:v,originX:l,originY:u,isAvailableBehavior:null})}if(i){var f=Math.abs(o),p=(o>0?1:-1)*(f>3?.4:f>1?.15:.05);re(this,"scrollMove","moveOnMouseWheel",e,{scrollDelta:p,originX:l,originY:u,isAvailableBehavior:null})}}},a.prototype._pinchHandler=function(e){if(!Le(this._zr,"globalPan")){var t=e.pinchScale>1?1.1:1/1.1;re(this,"zoom",null,e,{scale:t,originX:e.pinchX,originY:e.pinchY,isAvailableBehavior:null})}},a}(ct);function re(r,a,e,t,i){r.pointerChecker&&r.pointerChecker(t,i.originX,i.originY)&&(qe(t.event),Qe(r,a,e,t,i))}function Qe(r,a,e,t,i){i.isAvailableBehavior=G(q,null,e,t),r.trigger(a,i)}function q(r,a,e){var t=e[r];return!r||t&&(!mt(t)||a.event[t+"Key"])}var Ut=zt,Ee=["treemapZoomToNode","treemapRender","treemapMove"];function Ft(r){for(var a=0;a<Ee.length;a++)r.registerAction({type:Ee[a],update:"updateView"},Ue);r.registerAction({type:"treemapRootToNode",update:"updateView"},function(e,t){t.eachComponent({mainType:"series",subType:"treemap",query:e},i);function i(o,n){var l=["treemapZoomToNode","treemapRootToNode"],u=ve(e,l,o);if(u){var s=o.getViewRoot();s&&(e.direction=Ze(s,u.node)?"rollUp":"drillDown"),o.resetViewRoot(u.node)}}})}var qt=function(r){he(a,r);function a(){var e=r!==null&&r.apply(this,arguments)||this;return e.type=a.type,e.preventUsingHoverLayer=!0,e}return a.prototype.getInitialData=function(e,t){var i={name:e.name,children:e.data};et(i);var o=e.levels||[],n=this.designatedVisualItemStyle={},l=new le({itemStyle:n},this,t);o=e.levels=$t(o,t);var u=yt(o||[],function(f){return new le(f,l,t)},this),s=ht.createTree(i,this,v);function v(f){f.wrapMethod("getItemModel",function(p,g){var y=s.getNodeByDataIndex(g),h=y?u[y.depth]:null;return p.parentModel=h||l,p})}return s.data},a.prototype.optionUpdated=function(){this.resetViewRoot()},a.prototype.formatTooltip=function(e,t,i){var o=this.getData(),n=this.getRawValue(e),l=o.getName(e);return wt("nameValue",{name:l,value:n})},a.prototype.getDataParams=function(e){var t=r.prototype.getDataParams.apply(this,arguments),i=this.getData().tree.getNodeByDataIndex(e);return t.treeAncestors=ze(i,this),t.treePathInfo=t.treeAncestors,t},a.prototype.setLayoutInfo=function(e){this.layoutInfo=this.layoutInfo||{},Y(this.layoutInfo,e)},a.prototype.mapIdToIndex=function(e){var t=this._idIndexMap;t||(t=this._idIndexMap=bt(),this._idIndexMapCount=0);var i=t.get(e);return i==null&&t.set(e,i=this._idIndexMapCount++),i},a.prototype.getViewRoot=function(){return this._viewRoot},a.prototype.resetViewRoot=function(e){e?this._viewRoot=e:e=this._viewRoot;var t=this.getRawData().tree.root;(!e||e!==t&&!t.contains(e))&&(this._viewRoot=t)},a.prototype.enableAriaDecal=function(){dt(this)},a.type="series.treemap",a.layoutMode="box",a.defaultOption={progressive:0,left:"center",top:"middle",width:"80%",height:"80%",sort:!0,clipWindow:"origin",squareRatio:.5*(1+Math.sqrt(5)),leafDepth:null,drillDownIcon:"\u25B6",zoomToNodeRatio:.32*.32,roam:!0,nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",top:"bottom",emptyItemWidth:25,itemStyle:{color:"rgba(0,0,0,0.7)",textStyle:{color:"#fff"}},emphasis:{itemStyle:{color:"rgba(0,0,0,0.9)"}}},label:{show:!0,distance:0,padding:5,position:"inside",color:"#fff",overflow:"truncate"},upperLabel:{show:!1,position:[0,"50%"],height:20,overflow:"truncate",verticalAlign:"middle"},itemStyle:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:"#fff",borderColorSaturation:null},emphasis:{upperLabel:{show:!0,position:[0,"50%"],overflow:"truncate",verticalAlign:"middle"}},visualDimension:0,visualMin:null,visualMax:null,color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},a}(xt);function et(r){var a=0;V(r.children,function(t){et(t);var i=t.value;F(i)&&(i=i[0]),a+=i});var e=r.value;F(e)&&(e=e[0]),(e==null||isNaN(e))&&(e=a),e<0&&(e=0),F(r.value)?r.value[0]=e:r.value=e}function $t(r,a){var e=Ie(a.get("color")),t=Ie(a.get(["aria","decal","decals"]));if(!!e){r=r||[];var i,o;V(r,function(l){var u=new le(l),s=u.get("color"),v=u.get("decal");(u.get(["itemStyle","color"])||s&&s!=="none")&&(i=!0),(u.get(["itemStyle","decal"])||v&&v!=="none")&&(o=!0)});var n=r[0]||(r[0]={});return i||(n.color=e.slice()),!o&&t&&(n.decal=t.slice()),r}}var Kt=qt,Jt=8,ke=8,ie=5,jt=function(){function r(a){this.group=new j,a.add(this.group)}return r.prototype.render=function(a,e,t,i){var o=a.getModel("breadcrumb"),n=this.group;if(n.removeAll(),!(!o.get("show")||!t)){var l=o.getModel("itemStyle"),u=o.getModel("emphasis"),s=l.getModel("textStyle"),v=u.getModel(["itemStyle","textStyle"]),f={pos:{left:o.get("left"),right:o.get("right"),top:o.get("top"),bottom:o.get("bottom")},box:{width:e.getWidth(),height:e.getHeight()},emptyItemWidth:o.get("emptyItemWidth"),totalWidth:0,renderList:[]};this._prepare(t,f,s),this._renderContent(a,f,l,u,s,v,i),_t(n,f.pos,f.box)}},r.prototype._prepare=function(a,e,t){for(var i=a;i;i=i.parentNode){var o=$e(i.getModel().get("name"),""),n=t.getTextRect(o),l=Math.max(n.width+Jt*2,e.emptyItemWidth);e.totalWidth+=l+ke,e.renderList.push({node:i,text:o,width:l})}},r.prototype._renderContent=function(a,e,t,i,o,n,l){for(var u=0,s=e.emptyItemWidth,v=a.get(["breadcrumb","height"]),f=It(e.pos,e.box),p=e.totalWidth,g=e.renderList,y=i.getModel("itemStyle").getItemStyle(),h=g.length-1;h>=0;h--){var d=g[h],c=d.node,w=d.width,b=d.text;p>f.width&&(p-=w-s,w=s,b=null);var x=new Tt({shape:{points:Qt(u,0,w,v,h===g.length-1,h===0)},style:Fe(t.getItemStyle(),{lineJoin:"bevel"}),textContent:new St({style:Te(o,{text:b})}),textConfig:{position:"inside"},z2:Q*1e4,onclick:Ke(l,c)});x.disableLabelAnimation=!0,x.getTextContent().ensureState("emphasis").style=Te(n,{text:b}),x.ensureState("emphasis").style=y,Mt(x,i.get("focus"),i.get("blurScope"),i.get("disabled")),this.group.add(x),ea(x,a,c),u+=w+ke}},r.prototype.remove=function(){this.group.removeAll()},r}();function Qt(r,a,e,t,i,o){var n=[[i?r:r-ie,a],[r+e,a],[r+e,a+t],[i?r:r-ie,a+t]];return!o&&n.splice(2,0,[r+e+ie,a+t/2]),!i&&n.push([r,a+t/2]),n}function ea(r,a,e){se(r).eventData={componentType:"series",componentSubType:"treemap",componentIndex:a.componentIndex,seriesIndex:a.seriesIndex,seriesName:a.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:e&&e.dataIndex,name:e&&e.name},treePathInfo:e&&ze(e,a)}}var ta=jt,aa=function(){function r(){this._storage=[],this._elExistsMap={}}return r.prototype.add=function(a,e,t,i,o){return this._elExistsMap[a.id]?!1:(this._elExistsMap[a.id]=!0,this._storage.push({el:a,target:e,duration:t,delay:i,easing:o}),!0)},r.prototype.finished=function(a){return this._finishedCallback=a,this},r.prototype.start=function(){for(var a=this,e=this._storage.length,t=function(){e--,e<=0&&(a._storage.length=0,a._elExistsMap={},a._finishedCallback&&a._finishedCallback())},i=0,o=this._storage.length;i<o;i++){var n=this._storage[i];n.el.animateTo(n.target,{duration:n.duration,delay:n.delay,easing:n.easing,setToFinal:!0,done:t,aborted:t})}return this},r}();function ra(){return new aa}var ue=j,We=Gt,Pe=3,Ge="label",Oe="upperLabel",ia=Q*10,na=Q*2,oa=Q*3,N=Dt([["fill","color"],["stroke","strokeColor"],["lineWidth","strokeWidth"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),Ne=function(r){var a=N(r);return a.stroke=a.fill=a.lineWidth=null,a},K=Je(),la=function(r){he(a,r);function a(){var e=r!==null&&r.apply(this,arguments)||this;return e.type=a.type,e._state="ready",e._storage=Z(),e}return a.prototype.render=function(e,t,i,o){var n=t.findComponents({mainType:"series",subType:"treemap",query:o});if(!(At(n,e)<0)){this.seriesModel=e,this.api=i,this.ecModel=t;var l=["treemapZoomToNode","treemapRootToNode"],u=ve(o,l,e),s=o&&o.type,v=e.layoutInfo,f=!this._oldTree,p=this._storage,g=s==="treemapRootToNode"&&u&&p?{rootNodeGroup:p.nodeGroup[u.node.getRawIndex()],direction:o.direction}:null,y=this._giveContainerGroup(v),h=e.get("animation"),d=this._doRender(y,e,g);h&&!f&&(!s||s==="treemapZoomToNode"||s==="treemapRootToNode")?this._doAnimation(y,d,e,g):d.renderFinally(),this._resetController(i),this._renderBreadcrumb(e,i,u)}},a.prototype._giveContainerGroup=function(e){var t=this._containerGroup;return t||(t=this._containerGroup=new ue,this._initEvents(t),this.group.add(t)),t.x=e.x,t.y=e.y,t},a.prototype._doRender=function(e,t,i){var o=t.getData().tree,n=this._oldTree,l=Z(),u=Z(),s=this._storage,v=[];function f(d,c,w,b){return sa(t,u,s,i,l,v,d,c,w,b)}g(o.root?[o.root]:[],n&&n.root?[n.root]:[],e,o===n||!n,0);var p=y(s);return this._oldTree=o,this._storage=u,{lastsForAnimation:l,willDeleteEls:p,renderFinally:h};function g(d,c,w,b,x){b?(c=d,V(d,function(C,R){!C.isRemoved()&&L(R,R)})):new Ct(c,d,A,A).add(L).update(L).remove(Ke(L,null)).execute();function A(C){return C.getId()}function L(C,R){var O=C!=null?d[C]:null,B=R!=null?c[R]:null,S=f(O,B,w,x);S&&g(O&&O.viewChildren||[],B&&B.viewChildren||[],S,b,x+1)}}function y(d){var c=Z();return d&&V(d,function(w,b){var x=c[b];V(w,function(A){A&&(x.push(A),K(A).willDelete=!0)})}),c}function h(){V(p,function(d){V(d,function(c){c.parent&&c.parent.remove(c)})}),V(v,function(d){d.invisible=!0,d.dirty()})}},a.prototype._doAnimation=function(e,t,i,o){var n=i.get("animationDurationUpdate"),l=i.get("animationEasing"),u=(Me(n)?0:n)||0,s=(Me(l)?null:l)||"cubicOut",v=ra();V(t.willDeleteEls,function(f,p){V(f,function(g,y){if(!g.invisible){var h=g.parent,d,c=K(h);if(o&&o.direction==="drillDown")d=h===o.rootNodeGroup?{shape:{x:0,y:0,width:c.nodeWidth,height:c.nodeHeight},style:{opacity:0}}:{style:{opacity:0}};else{var w=0,b=0;c.willDelete||(w=c.nodeWidth/2,b=c.nodeHeight/2),d=p==="nodeGroup"?{x:w,y:b,style:{opacity:0}}:{shape:{x:w,y:b,width:0,height:0},style:{opacity:0}}}d&&v.add(g,d,u,0,s)}})}),V(this._storage,function(f,p){V(f,function(g,y){var h=t.lastsForAnimation[p][y],d={};!h||(g instanceof j?h.oldX!=null&&(d.x=g.x,d.y=g.y,g.x=h.oldX,g.y=h.oldY):(h.oldShape&&(d.shape=Y({},g.shape),g.setShape(h.oldShape)),h.fadein?(g.setStyle("opacity",0),d.style={opacity:1}):g.style.opacity!==1&&(d.style={opacity:1})),v.add(g,d,u,0,s))})},this),this._state="animating",v.finished(G(function(){this._state="ready",t.renderFinally()},this)).start()},a.prototype._resetController=function(e){var t=this._controller;t||(t=this._controller=new Ut(e.getZr()),t.enable(this.seriesModel.get("roam")),t.on("pan",G(this._onPan,this)),t.on("zoom",G(this._onZoom,this)));var i=new $(0,0,e.getWidth(),e.getHeight());t.setPointerChecker(function(o,n,l){return i.contain(n,l)})},a.prototype._clearController=function(){var e=this._controller;e&&(e.dispose(),e=null)},a.prototype._onPan=function(e){if(this._state!=="animating"&&(Math.abs(e.dx)>Pe||Math.abs(e.dy)>Pe)){var t=this.seriesModel.getData().tree.root;if(!t)return;var i=t.getLayout();if(!i)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:i.x+e.dx,y:i.y+e.dy,width:i.width,height:i.height}})}},a.prototype._onZoom=function(e){var t=e.originX,i=e.originY;if(this._state!=="animating"){var o=this.seriesModel.getData().tree.root;if(!o)return;var n=o.getLayout();if(!n)return;var l=new $(n.x,n.y,n.width,n.height),u=this.seriesModel.layoutInfo;t-=u.x,i-=u.y;var s=Lt();Se(s,s,[-t,-i]),Rt(s,s,[e.scale,e.scale]),Se(s,s,[t,i]),l.applyTransform(s),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:l.x,y:l.y,width:l.width,height:l.height}})}},a.prototype._initEvents=function(e){var t=this;e.on("click",function(i){if(t._state==="ready"){var o=t.seriesModel.get("nodeClick",!0);if(!!o){var n=t.findTarget(i.offsetX,i.offsetY);if(!!n){var l=n.node;if(l.getLayout().isLeafRoot)t._rootToNode(n);else if(o==="zoomToNode")t._zoomToNode(n);else if(o==="link"){var u=l.hostTree.data.getItemModel(l.dataIndex),s=u.get("link",!0),v=u.get("target",!0)||"blank";s&&Vt(s,v)}}}}},this)},a.prototype._renderBreadcrumb=function(e,t,i){var o=this;i||(i=e.get("leafDepth",!0)!=null?{node:e.getViewRoot()}:this.findTarget(t.getWidth()/2,t.getHeight()/2),i||(i={node:e.getData().tree.root})),(this._breadcrumb||(this._breadcrumb=new ta(this.group))).render(e,t,i.node,function(n){o._state!=="animating"&&(Ze(e.getViewRoot(),n)?o._rootToNode({node:n}):o._zoomToNode({node:n}))})},a.prototype.remove=function(){this._clearController(),this._containerGroup&&this._containerGroup.removeAll(),this._storage=Z(),this._state="ready",this._breadcrumb&&this._breadcrumb.remove()},a.prototype.dispose=function(){this._clearController()},a.prototype._zoomToNode=function(e){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:e.node})},a.prototype._rootToNode=function(e){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:e.node})},a.prototype.findTarget=function(e,t){var i,o=this.seriesModel.getViewRoot();return o.eachNode({attr:"viewChildren",order:"preorder"},function(n){var l=this._storage.background[n.getRawIndex()];if(l){var u=l.transformCoordToLocal(e,t),s=l.shape;if(s.x<=u[0]&&u[0]<=s.x+s.width&&s.y<=u[1]&&u[1]<=s.y+s.height)i={node:n,offsetX:u[0],offsetY:u[1]};else return!1}},this),i},a.type="treemap",a}(Ht);function Z(){return{nodeGroup:[],background:[],content:[]}}function sa(r,a,e,t,i,o,n,l,u,s){if(!n)return;var v=n.getLayout(),f=r.getData(),p=n.getModel();if(f.setItemGraphicEl(n.dataIndex,null),!v||!v.isInView)return;var g=v.width,y=v.height,h=v.borderWidth,d=v.invisible,c=n.getRawIndex(),w=l&&l.getRawIndex(),b=n.viewChildren,x=v.upperHeight,A=b&&b.length,L=p.getModel("itemStyle"),C=p.getModel(["emphasis","itemStyle"]),R=p.getModel(["blur","itemStyle"]),O=p.getModel(["select","itemStyle"]),B=L.get("borderRadius")||0,S=ae("nodeGroup",ue);if(!S)return;if(u.add(S),S.x=v.x||0,S.y=v.y||0,S.markRedraw(),K(S).nodeWidth=g,K(S).nodeHeight=y,v.isAboveViewRoot)return S;var W=ae("background",We,s,na);W&&lt(S,W,A&&v.upperLabelHeight);var ee=p.getModel("emphasis"),te=ee.get("focus"),fe=ee.get("blurScope"),pe=ee.get("disabled"),ge=te==="ancestor"?n.getAncestorsIndices():te==="descendant"?n.getDescendantIndices():te;if(A)De(S)&&U(S,!1),W&&(U(W,!pe),f.setItemGraphicEl(n.dataIndex,W),Ae(W,ge,fe));else{var ce=ae("content",We,s,oa);ce&&st(S,ce),W.disableMorphing=!0,W&&De(W)&&U(W,!1),U(S,!pe),f.setItemGraphicEl(n.dataIndex,S),Ae(S,ge,fe)}return S;function lt(_,m,M){var I=se(m);if(I.dataIndex=n.dataIndex,I.seriesIndex=r.seriesIndex,m.setShape({x:0,y:0,width:g,height:y,r:B}),d)me(m);else{m.invisible=!1;var T=n.getVisual("style"),H=T.stroke,E=Ne(L);E.fill=H;var D=N(C);D.fill=C.get("borderColor");var k=N(R);k.fill=R.get("borderColor");var P=N(O);if(P.fill=O.get("borderColor"),M){var X=g-2*h;ye(m,H,T.opacity,{x:h,y:0,width:X,height:x})}else m.removeTextContent();m.setStyle(E),m.ensureState("emphasis").style=D,m.ensureState("blur").style=k,m.ensureState("select").style=P,Ce(m)}_.add(m)}function st(_,m){var M=se(m);M.dataIndex=n.dataIndex,M.seriesIndex=r.seriesIndex;var I=Math.max(g-2*h,0),T=Math.max(y-2*h,0);if(m.culling=!0,m.setShape({x:h,y:h,width:I,height:T,r:B}),d)me(m);else{m.invisible=!1;var H=n.getVisual("style"),E=H.fill,D=Ne(L);D.fill=E,D.decal=H.decal;var k=N(C),P=N(R),X=N(O);ye(m,E,H.opacity,null),m.setStyle(D),m.ensureState("emphasis").style=k,m.ensureState("blur").style=P,m.ensureState("select").style=X,Ce(m)}_.add(m)}function me(_){!_.invisible&&o.push(_)}function ye(_,m,M,I){var T=p.getModel(I?Oe:Ge),H=$e(p.get("name"),null),E=T.getShallow("show");Et(_,kt(p,I?Oe:Ge),{defaultText:E?H:null,inheritColor:m,defaultOpacity:M,labelFetcher:r,labelDataIndex:n.dataIndex});var D=_.getTextContent();if(!!D){var k=D.style,P=Wt(k.padding||0);I&&(_.setTextConfig({layoutRect:I}),D.disableLabelLayout=!0),D.beforeUpdate=function(){var be=Math.max((I?I.width:_.shape.width)-P[1]-P[3],0),xe=Math.max((I?I.height:_.shape.height)-P[0]-P[2],0);(k.width!==be||k.height!==xe)&&D.setStyle({width:be,height:xe})},k.truncateMinChar=2,k.lineOverflow="truncate",we(k,I,v);var X=D.getState("emphasis");we(X?X.style:null,I,v)}}function we(_,m,M){var I=_?_.text:null;if(!m&&M.isLeafRoot&&I!=null){var T=r.get("drillDownIcon",!0);_.text=T?T+" "+I:I}}function ae(_,m,M,I){var T=w!=null&&e[_][w],H=i[_];return T?(e[_][w]=null,ut(H,T)):d||(T=new m,T instanceof Pt&&(T.z2=ua(M,I)),vt(H,T)),a[_][c]=T}function ut(_,m){var M=_[c]={};m instanceof ue?(M.oldX=m.x,M.oldY=m.y):M.oldShape=Y({},m.shape)}function vt(_,m){var M=_[c]={},I=n.parentNode,T=m instanceof j;if(I&&(!t||t.direction==="drillDown")){var H=0,E=0,D=i.background[I.getRawIndex()];!t&&D&&D.oldShape&&(H=D.oldShape.width,E=D.oldShape.height),T?(M.oldX=0,M.oldY=E):M.oldShape={x:H,y:E,width:0,height:0}}M.fadein=!T}}function ua(r,a){return r*ia+a}var va=la,ha="itemStyle",tt=Je(),da={seriesType:"treemap",reset:function(r){var a=r.getData().tree,e=a.root;e.isRemoved()||at(e,{},r.getViewRoot().getAncestors(),r)}};function at(r,a,e,t){var i=r.getModel(),o=r.getLayout(),n=r.hostTree.data;if(!(!o||o.invisible||!o.isInView)){var l=i.getModel(ha),u=fa(l,a,t),s=n.ensureUniqueItemVisual(r.dataIndex,"style"),v=l.get("borderColor"),f=l.get("borderColorSaturation"),p;f!=null&&(p=Be(u),v=pa(f,p)),s.stroke=v;var g=r.viewChildren;if(!g||!g.length)p=Be(u),s.fill=p;else{var y=ga(r,i,o,l,u,g);V(g,function(h,d){if(h.depth>=e.length||h===e[h.depth]){var c=ca(i,u,h,d,y,t);at(h,c,e,t)}})}}}function fa(r,a,e){var t=Y({},a),i=e.designatedVisualItemStyle;return V(["color","colorAlpha","colorSaturation"],function(o){i[o]=a[o];var n=r.get(o);i[o]=null,n!=null&&(t[o]=n)}),t}function Be(r){var a=ne(r,"color");if(a){var e=ne(r,"colorAlpha"),t=ne(r,"colorSaturation");return t&&(a=je(a,null,null,t)),e&&(a=Ot(a,e)),a}}function pa(r,a){return a!=null?je(a,null,null,r):null}function ne(r,a){var e=r[a];if(e!=null&&e!=="none")return e}function ga(r,a,e,t,i,o){if(!(!o||!o.length)){var n=oe(a,"color")||i.color!=null&&i.color!=="none"&&(oe(a,"colorAlpha")||oe(a,"colorSaturation"));if(!!n){var l=a.get("visualMin"),u=a.get("visualMax"),s=e.dataExtent.slice();l!=null&&l<s[0]&&(s[0]=l),u!=null&&u>s[1]&&(s[1]=u);var v=a.get("colorMappingBy"),f={type:n.name,dataExtent:s,visual:n.range};f.type==="color"&&(v==="index"||v==="id")?(f.mappingMethod="category",f.loop=!0):f.mappingMethod="linear";var p=new Yt(f);return tt(p).drColorMappingBy=v,p}}}function oe(r,a){var e=r.get(a);return F(e)&&e.length?{name:a,range:e}:null}function ca(r,a,e,t,i,o){var n=Y({},a);if(i){var l=i.type,u=l==="color"&&tt(i).drColorMappingBy,s=u==="index"?t:u==="id"?o.mapIdToIndex(e.getId()):e.getValue(r.get("visualDimension"));n[l]=i.mapValueToVisual(s)}return n}var z=Math.max,J=Math.min,Xe=Bt,de=V,rt=["itemStyle","borderWidth"],ma=["itemStyle","gapWidth"],ya=["upperLabel","show"],wa=["upperLabel","height"],ba={seriesType:"treemap",reset:function(r,a,e,t){var i=e.getWidth(),o=e.getHeight(),n=r.option,l=Nt(r.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()}),u=n.size||[],s=Re(Xe(l.width,u[0]),i),v=Re(Xe(l.height,u[1]),o),f=t&&t.type,p=["treemapZoomToNode","treemapRootToNode"],g=ve(t,p,r),y=f==="treemapRender"||f==="treemapMove"?t.rootRect:null,h=r.getViewRoot(),d=ft(h);if(f!=="treemapMove"){var c=f==="treemapZoomToNode"?Ma(r,g,h,s,v):y?[y.width,y.height]:[s,v],w=n.sort;w&&w!=="asc"&&w!=="desc"&&(w="desc");var b={squareRatio:n.squareRatio,sort:w,leafDepth:n.leafDepth};h.hostTree.clearLayouts();var x={x:0,y:0,width:c[0],height:c[1],area:c[0]*c[1]};h.setLayout(x),it(h,b,!1,0),x=h.getLayout(),de(d,function(L,C){var R=(d[C+1]||h).getValue();L.setLayout(Y({dataExtent:[R,R],borderWidth:0,upperHeight:0},x))})}var A=r.getData().tree.root;A.setLayout(Da(l,y,g),!0),r.setLayoutInfo(l),nt(A,new $(-l.x,-l.y,i,o),d,h,0)}};function it(r,a,e,t){var i,o;if(!r.isRemoved()){var n=r.getLayout();i=n.width,o=n.height;var l=r.getModel(),u=l.get(rt),s=l.get(ma)/2,v=ot(l),f=Math.max(u,v),p=u-s,g=f-s;r.setLayout({borderWidth:u,upperHeight:f,upperLabelHeight:v},!0),i=z(i-2*p,0),o=z(o-p-g,0);var y=i*o,h=xa(r,l,y,a,e,t);if(!!h.length){var d={x:p,y:g,width:i,height:o},c=J(i,o),w=1/0,b=[];b.area=0;for(var x=0,A=h.length;x<A;){var L=h[x];b.push(L),b.area+=L.getLayout().area;var C=Sa(b,c,a.squareRatio);C<=w?(x++,w=C):(b.area-=b.pop().getLayout().area,Ye(b,c,d,s,!1),c=J(d.width,d.height),b.length=b.area=0,w=1/0)}if(b.length&&Ye(b,c,d,s,!0),!e){var R=l.get("childrenVisibleMin");R!=null&&y<R&&(e=!0)}for(var x=0,A=h.length;x<A;x++)it(h[x],a,e,t+1)}}}function xa(r,a,e,t,i,o){var n=r.children||[],l=t.sort;l!=="asc"&&l!=="desc"&&(l=null);var u=t.leafDepth!=null&&t.leafDepth<=o;if(i&&!u)return r.viewChildren=[];n=Xt(n,function(g){return!g.isRemoved()}),Ia(n,l);var s=Ta(a,n,l);if(s.sum===0)return r.viewChildren=[];if(s.sum=_a(a,e,s.sum,l,n),s.sum===0)return r.viewChildren=[];for(var v=0,f=n.length;v<f;v++){var p=n[v].getValue()/s.sum*e;n[v].setLayout({area:p})}return u&&(n.length&&r.setLayout({isLeafRoot:!0},!0),n.length=0),r.viewChildren=n,r.setLayout({dataExtent:s.dataExtent},!0),n}function _a(r,a,e,t,i){if(!t)return e;for(var o=r.get("visibleMin"),n=i.length,l=n,u=n-1;u>=0;u--){var s=i[t==="asc"?n-u-1:u].getValue();s/e*a<o&&(l=u,e-=s)}return t==="asc"?i.splice(0,n-l):i.splice(l,n-l),e}function Ia(r,a){return a&&r.sort(function(e,t){var i=a==="asc"?e.getValue()-t.getValue():t.getValue()-e.getValue();return i===0?a==="asc"?e.dataIndex-t.dataIndex:t.dataIndex-e.dataIndex:i}),r}function Ta(r,a,e){for(var t=0,i=0,o=a.length;i<o;i++)t+=a[i].getValue();var n=r.get("visualDimension"),l;return!a||!a.length?l=[NaN,NaN]:n==="value"&&e?(l=[a[a.length-1].getValue(),a[0].getValue()],e==="asc"&&l.reverse()):(l=[1/0,-1/0],de(a,function(u){var s=u.getValue(n);s<l[0]&&(l[0]=s),s>l[1]&&(l[1]=s)})),{sum:t,dataExtent:l}}function Sa(r,a,e){for(var t=0,i=1/0,o=0,n=void 0,l=r.length;o<l;o++)n=r[o].getLayout().area,n&&(n<i&&(i=n),n>t&&(t=n));var u=r.area*r.area,s=a*a*e;return u?z(s*t/u,u/(s*i)):1/0}function Ye(r,a,e,t,i){var o=a===e.width?0:1,n=1-o,l=["x","y"],u=["width","height"],s=e[l[o]],v=a?r.area/a:0;(i||v>e[u[n]])&&(v=e[u[n]]);for(var f=0,p=r.length;f<p;f++){var g=r[f],y={},h=v?g.getLayout().area/v:0,d=y[u[n]]=z(v-2*t,0),c=e[l[o]]+e[u[o]]-s,w=f===p-1||c<h?c:h,b=y[u[o]]=z(w-2*t,0);y[l[n]]=e[l[n]]+J(t,d/2),y[l[o]]=s+J(t,b/2),s+=w,g.setLayout(y,!0)}e[l[n]]+=v,e[u[n]]-=v}function Ma(r,a,e,t,i){var o=(a||{}).node,n=[t,i];if(!o||o===e)return n;for(var l,u=t*i,s=u*r.option.zoomToNodeRatio;l=o.parentNode;){for(var v=0,f=l.children,p=0,g=f.length;p<g;p++)v+=f[p].getValue();var y=o.getValue();if(y===0)return n;s*=v/y;var h=l.getModel(),d=h.get(rt),c=Math.max(d,ot(h));s+=4*d*d+(3*d+c)*Math.pow(s,.5),s>Ve&&(s=Ve),o=l}s<u&&(s=u);var w=Math.pow(s/u,.5);return[t*w,i*w]}function Da(r,a,e){if(a)return{x:a.x,y:a.y};var t={x:0,y:0};if(!e)return t;var i=e.node,o=i.getLayout();if(!o)return t;for(var n=[o.width/2,o.height/2],l=i;l;){var u=l.getLayout();n[0]+=u.x,n[1]+=u.y,l=l.parentNode}return{x:r.width/2-n[0],y:r.height/2-n[1]}}function nt(r,a,e,t,i){var o=r.getLayout(),n=e[i],l=n&&n===r;if(!(n&&!l||i===e.length&&r!==t)){r.setLayout({isInView:!0,invisible:!l&&!a.intersect(o),isAboveViewRoot:l},!0);var u=new $(a.x-o.x,a.y-o.y,a.width,a.height);de(r.viewChildren||[],function(s){nt(s,u,e,t,i+1)})}}function ot(r){return r.get(ya)?r.get(wa):0}function Va(r){r.registerSeriesModel(Kt),r.registerChartView(va),r.registerVisual(da),r.registerLayout(ba),Ft(r)}export{Va as i};
