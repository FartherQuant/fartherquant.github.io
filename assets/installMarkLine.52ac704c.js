import{M as ot,a as ct,g as yt,n as mt,d as j,b as F,c as vt,e as ht}from"./MarkerView.695cf5c3.js";import{bg as gt,bh as bt,_ as w,bi as nt,a1 as dt,c as St,a as T,u as Lt,k as st,aI as X,j as It,aB as kt,i as E,t as _t,ar as At,as as Mt,bj as Nt,G as lt,n as ut,at as ft,o as Et,a3 as Pt,a6 as Q,b9 as Ot,bk as z,m as V,e as Y,S as G,ac as W,bl as Vt,bm as wt,bb as zt,bn as Rt,h as Dt,Q as Tt,x as q,L as J,aa as Gt}from"./index.esm.min.5835493e.js";var Z=gt.prototype,C=bt.prototype,pt=function(){function a(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return a}();(function(a){w(t,a);function t(){return a!==null&&a.apply(this,arguments)||this}return t})(pt);function K(a){return isNaN(+a.cpx1)||isNaN(+a.cpy1)}var Ct=function(a){w(t,a);function t(r){var e=a.call(this,r)||this;return e.type="ec-line",e}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new pt},t.prototype.buildPath=function(r,e){K(e)?Z.buildPath.call(this,r,e):C.buildPath.call(this,r,e)},t.prototype.pointAt=function(r){return K(this.shape)?Z.pointAt.call(this,r):C.pointAt.call(this,r)},t.prototype.tangentAt=function(r){var e=this.shape,o=K(e)?[e.x2-e.x1,e.y2-e.y1]:C.tangentAt.call(this,r);return nt(o,o)},t}(dt),Kt=Ct,B=["fromSymbol","toSymbol"];function x(a){return"_"+a+"Type"}function tt(a,t,r){var e=t.getItemVisual(r,a);if(!e||e==="none")return e;var o=t.getItemVisual(r,a+"Size"),i=t.getItemVisual(r,a+"Rotate"),n=t.getItemVisual(r,a+"Offset"),s=t.getItemVisual(r,a+"KeepAspect"),l=ut(o),u=ft(n||0,l);return e+l+u+(i||"")+(s||"")}function et(a,t,r){var e=t.getItemVisual(r,a);if(!(!e||e==="none")){var o=t.getItemVisual(r,a+"Size"),i=t.getItemVisual(r,a+"Rotate"),n=t.getItemVisual(r,a+"Offset"),s=t.getItemVisual(r,a+"KeepAspect"),l=ut(o),u=ft(n||0,l),f=Et(e,-l[0]/2+u[0],-l[1]/2+u[1],l[0],l[1],null,s);return f.__specifiedRotation=i==null||isNaN(i)?void 0:+i*Math.PI/180||0,f.name=a,f}}function Bt(a){var t=new Kt({name:"line",subPixelOptimize:!0});return H(t.shape,a),t}function H(a,t){a.x1=t[0][0],a.y1=t[0][1],a.x2=t[1][0],a.y2=t[1][1],a.percent=1;var r=t[2];r?(a.cpx1=r[0],a.cpy1=r[1]):(a.cpx1=NaN,a.cpy1=NaN)}var $t=function(a){w(t,a);function t(r,e,o){var i=a.call(this)||this;return i._createLine(r,e,o),i}return t.prototype._createLine=function(r,e,o){var i=r.hostModel,n=r.getItemLayout(e),s=Bt(n);s.shape.percent=0,St(s,{shape:{percent:1}},i,e),this.add(s),T(B,function(l){var u=et(l,r,e);this.add(u),this[x(l)]=tt(l,r,e)},this),this._updateCommonStl(r,e,o)},t.prototype.updateData=function(r,e,o){var i=r.hostModel,n=this.childOfName("line"),s=r.getItemLayout(e),l={shape:{}};H(l.shape,s),Lt(n,l,i,e),T(B,function(u){var f=tt(u,r,e),y=x(u);if(this[y]!==f){this.remove(this.childOfName(u));var c=et(u,r,e);this.add(c)}this[y]=f},this),this._updateCommonStl(r,e,o)},t.prototype.getLinePath=function(){return this.childAt(0)},t.prototype._updateCommonStl=function(r,e,o){var i=r.hostModel,n=this.childOfName("line"),s=o&&o.emphasisLineStyle,l=o&&o.blurLineStyle,u=o&&o.selectLineStyle,f=o&&o.labelStatesModels,y=o&&o.emphasisDisabled,c=o&&o.focus,v=o&&o.blurScope;if(!o||r.hasItemOption){var m=r.getItemModel(e),b=m.getModel("emphasis");s=b.getModel("lineStyle").getLineStyle(),l=m.getModel(["blur","lineStyle"]).getLineStyle(),u=m.getModel(["select","lineStyle"]).getLineStyle(),y=b.get("disabled"),c=b.get("focus"),v=b.get("blurScope"),f=st(m)}var h=r.getItemVisual(e,"style"),S=h.stroke;n.useStyle(h),n.style.fill=null,n.style.strokeNoScale=!0,n.ensureState("emphasis").style=s,n.ensureState("blur").style=l,n.ensureState("select").style=u,T(B,function(k){var d=this.childOfName(k);if(d){d.setColor(S),d.style.opacity=h.opacity;for(var A=0;A<X.length;A++){var _=X[A],N=n.getState(_);if(N){var M=N.style||{},P=d.ensureState(_),O=P.style||(P.style={});M.stroke!=null&&(O[d.__isEmptyBrush?"stroke":"fill"]=M.stroke),M.opacity!=null&&(O.opacity=M.opacity)}}d.markRedraw()}},this);var L=i.getRawValue(e);It(this,f,{labelDataIndex:e,labelFetcher:{getFormattedLabel:function(k,d){return i.getFormattedLabel(k,d,r.dataType)}},inheritColor:S||"#000",defaultOpacity:h.opacity,defaultText:(L==null?r.getName(e):isFinite(L)?kt(L):L)+""});var I=this.getTextContent();if(I){var p=f.normal;I.__align=I.style.align,I.__verticalAlign=I.style.verticalAlign,I.__position=p.get("position")||"middle";var g=p.get("distance");E(g)||(g=[g,g]),I.__labelDistance=g}this.setTextConfig({position:null,local:!0,inside:!1}),_t(this,c,v,y)},t.prototype.highlight=function(){At(this)},t.prototype.downplay=function(){Mt(this)},t.prototype.updateLayout=function(r,e){this.setLinePoints(r.getItemLayout(e))},t.prototype.setLinePoints=function(r){var e=this.childOfName("line");H(e.shape,r),e.dirty()},t.prototype.beforeUpdate=function(){var r=this,e=r.childOfName("fromSymbol"),o=r.childOfName("toSymbol"),i=r.getTextContent();if(!e&&!o&&(!i||i.ignore))return;for(var n=1,s=this.parent;s;)s.scaleX&&(n/=s.scaleX),s=s.parent;var l=r.childOfName("line");if(!this.__dirty&&!l.__dirty)return;var u=l.shape.percent,f=l.pointAt(0),y=l.pointAt(u),c=Nt([],y,f);nt(c,c);function v(N,M){var P=N.__specifiedRotation;if(P==null){var O=l.tangentAt(M);N.attr("rotation",(M===1?-1:1)*Math.PI/2-Math.atan2(O[1],O[0]))}else N.attr("rotation",P)}if(e&&(e.setPosition(f),v(e,0),e.scaleX=e.scaleY=n*u,e.markRedraw()),o&&(o.setPosition(y),v(o,1),o.scaleX=o.scaleY=n*u,o.markRedraw()),i&&!i.ignore){i.x=i.y=0,i.originX=i.originY=0;var m=void 0,b=void 0,h=i.__labelDistance,S=h[0]*n,L=h[1]*n,I=u/2,p=l.tangentAt(I),g=[p[1],-p[0]],k=l.pointAt(I);g[1]>0&&(g[0]=-g[0],g[1]=-g[1]);var d=p[0]<0?-1:1;if(i.__position!=="start"&&i.__position!=="end"){var A=-Math.atan2(p[1],p[0]);y[0]<f[0]&&(A=Math.PI+A),i.rotation=A}var _=void 0;switch(i.__position){case"insideStartTop":case"insideMiddleTop":case"insideEndTop":case"middle":_=-L,b="bottom";break;case"insideStartBottom":case"insideMiddleBottom":case"insideEndBottom":_=L,b="top";break;default:_=0,b="middle"}switch(i.__position){case"end":i.x=c[0]*S+y[0],i.y=c[1]*L+y[1],m=c[0]>.8?"left":c[0]<-.8?"right":"center",b=c[1]>.8?"top":c[1]<-.8?"bottom":"middle";break;case"start":i.x=-c[0]*S+f[0],i.y=-c[1]*L+f[1],m=c[0]>.8?"right":c[0]<-.8?"left":"center",b=c[1]>.8?"bottom":c[1]<-.8?"top":"middle";break;case"insideStartTop":case"insideStart":case"insideStartBottom":i.x=S*d+f[0],i.y=f[1]+_,m=p[0]<0?"right":"left",i.originX=-S*d,i.originY=-_;break;case"insideMiddleTop":case"insideMiddle":case"insideMiddleBottom":case"middle":i.x=k[0],i.y=k[1]+_,m="center",i.originY=-_;break;case"insideEndTop":case"insideEnd":case"insideEndBottom":i.x=-S*d+y[0],i.y=y[1]+_,m=p[0]>=0?"right":"left",i.originX=S*d,i.originY=-_;break}i.scaleX=i.scaleY=n,i.setStyle({verticalAlign:i.__verticalAlign||b,align:i.__align||m})}},t}(lt),Ut=$t,Yt=function(){function a(t){this.group=new lt,this._LineCtor=t||Ut}return a.prototype.updateData=function(t){var r=this;this._progressiveEls=null;var e=this,o=e.group,i=e._lineData;e._lineData=t,i||o.removeAll();var n=at(t);t.diff(i).add(function(s){r._doAdd(t,s,n)}).update(function(s,l){r._doUpdate(i,t,l,s,n)}).remove(function(s){o.remove(i.getItemGraphicEl(s))}).execute()},a.prototype.updateLayout=function(){var t=this._lineData;!t||t.eachItemGraphicEl(function(r,e){r.updateLayout(t,e)},this)},a.prototype.incrementalPrepareUpdate=function(t){this._seriesScope=at(t),this._lineData=null,this.group.removeAll()},a.prototype.incrementalUpdate=function(t,r){this._progressiveEls=[];function e(s){!s.isGroup&&!Ht(s)&&(s.incremental=!0,s.ensureState("emphasis").hoverLayer=!0)}for(var o=t.start;o<t.end;o++){var i=r.getItemLayout(o);if($(i)){var n=new this._LineCtor(r,o,this._seriesScope);n.traverse(e),this.group.add(n),r.setItemGraphicEl(o,n),this._progressiveEls.push(n)}}},a.prototype.remove=function(){this.group.removeAll()},a.prototype.eachRendered=function(t){Pt(this._progressiveEls||this.group,t)},a.prototype._doAdd=function(t,r,e){var o=t.getItemLayout(r);if(!!$(o)){var i=new this._LineCtor(t,r,e);t.setItemGraphicEl(r,i),this.group.add(i)}},a.prototype._doUpdate=function(t,r,e,o,i){var n=t.getItemGraphicEl(e);if(!$(r.getItemLayout(o))){this.group.remove(n);return}n?n.updateData(r,o,i):n=new this._LineCtor(r,o,i),r.setItemGraphicEl(o,n),this.group.add(n)},a}();function Ht(a){return a.animators&&a.animators.length>0}function at(a){var t=a.hostModel,r=t.getModel("emphasis");return{lineStyle:t.getModel("lineStyle").getLineStyle(),emphasisLineStyle:r.getModel(["lineStyle"]).getLineStyle(),blurLineStyle:t.getModel(["blur","lineStyle"]).getLineStyle(),selectLineStyle:t.getModel(["select","lineStyle"]).getLineStyle(),emphasisDisabled:r.get("disabled"),blurScope:r.get("blurScope"),focus:r.get("focus"),labelStatesModels:st(t)}}function rt(a){return isNaN(a[0])||isNaN(a[1])}function $(a){return a&&!rt(a[0])&&!rt(a[1])}var jt=Yt,Ft=function(a){w(t,a);function t(){var r=a!==null&&a.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.createMarkerModelFromSeries=function(r,e,o){return new t(r,e,o)},t.type="markLine",t.defaultOption={z:5,symbol:["circle","arrow"],symbolSize:[8,16],symbolOffset:0,precision:2,tooltip:{trigger:"item"},label:{show:!0,position:"end",distance:5},lineStyle:{type:"dashed"},emphasis:{label:{show:!0},lineStyle:{width:3}},animationEasing:"linear"},t}(ot),Xt=Ft,R=wt(),Qt=function(a,t,r,e){var o=a.getData(),i;if(E(e))i=e;else{var n=e.type;if(n==="min"||n==="max"||n==="average"||n==="median"||e.xAxis!=null||e.yAxis!=null){var s=void 0,l=void 0;if(e.yAxis!=null||e.xAxis!=null)s=t.getAxis(e.yAxis!=null?"y":"x"),l=zt(e.yAxis,e.xAxis);else{var u=yt(e,o,t,a);s=u.valueAxis;var f=Rt(o,u.valueDataDim);l=mt(o,f,n)}var y=s.dim==="x"?0:1,c=1-y,v=Dt(e),m={coord:[]};v.type=null,v.coord=[],v.coord[c]=-1/0,m.coord[c]=1/0;var b=r.get("precision");b>=0&&Tt(l)&&(l=+l.toFixed(Math.min(b,20))),v.coord[y]=m.coord[y]=l,i=[v,m,{type:n,valueIndex:e.valueIndex,value:l}]}else i=[]}var h=[j(a,i[0]),j(a,i[1]),Y({},i[2])];return h[2].type=h[2].type||null,q(h[2],h[0]),q(h[2],h[1]),h};function D(a){return!isNaN(a)&&!isFinite(a)}function it(a,t,r,e){var o=1-a,i=e.dimensions[a];return D(t[o])&&D(r[o])&&t[a]===r[a]&&e.getAxis(i).containData(t[a])}function Wt(a,t){if(a.type==="cartesian2d"){var r=t[0].coord,e=t[1].coord;if(r&&e&&(it(1,r,e,a)||it(0,r,e,a)))return!0}return F(a,t[0])&&F(a,t[1])}function U(a,t,r,e,o){var i=e.coordinateSystem,n=a.getItemModel(t),s,l=J(n.get("x"),o.getWidth()),u=J(n.get("y"),o.getHeight());if(!isNaN(l)&&!isNaN(u))s=[l,u];else{if(e.getMarkerPosition)s=e.getMarkerPosition(a.getValues(a.dimensions,t));else{var f=i.dimensions,y=a.get(f[0],t),c=a.get(f[1],t);s=i.dataToPoint([y,c])}if(Gt(i,"cartesian2d")){var v=i.getAxis("x"),m=i.getAxis("y"),f=i.dimensions;D(a.get(f[0],t))?s[0]=v.toGlobalCoord(v.getExtent()[r?0:1]):D(a.get(f[1],t))&&(s[1]=m.toGlobalCoord(m.getExtent()[r?0:1]))}isNaN(l)||(s[0]=l),isNaN(u)||(s[1]=u)}a.setItemLayout(t,s)}var qt=function(a){w(t,a);function t(){var r=a!==null&&a.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.updateTransform=function(r,e,o){e.eachSeries(function(i){var n=ot.getMarkerModelFromSeries(i,"markLine");if(n){var s=n.getData(),l=R(n).from,u=R(n).to;l.each(function(f){U(l,f,!0,i,o),U(u,f,!1,i,o)}),s.each(function(f){s.setItemLayout(f,[l.getItemLayout(f),u.getItemLayout(f)])}),this.markerGroupMap.get(i.id).updateLayout()}},this)},t.prototype.renderSeries=function(r,e,o,i){var n=r.coordinateSystem,s=r.id,l=r.getData(),u=this.markerGroupMap,f=u.get(s)||u.set(s,new jt);this.group.add(f.group);var y=Jt(n,r,e),c=y.from,v=y.to,m=y.line;R(e).from=c,R(e).to=v,e.setData(m);var b=e.get("symbol"),h=e.get("symbolSize"),S=e.get("symbolRotate"),L=e.get("symbolOffset");E(b)||(b=[b,b]),E(h)||(h=[h,h]),E(S)||(S=[S,S]),E(L)||(L=[L,L]),y.from.each(function(p){I(c,p,!0),I(v,p,!1)}),m.each(function(p){var g=m.getItemModel(p).getModel("lineStyle").getLineStyle();m.setItemLayout(p,[c.getItemLayout(p),v.getItemLayout(p)]),g.stroke==null&&(g.stroke=c.getItemVisual(p,"style").fill),m.setItemVisual(p,{fromSymbolKeepAspect:c.getItemVisual(p,"symbolKeepAspect"),fromSymbolOffset:c.getItemVisual(p,"symbolOffset"),fromSymbolRotate:c.getItemVisual(p,"symbolRotate"),fromSymbolSize:c.getItemVisual(p,"symbolSize"),fromSymbol:c.getItemVisual(p,"symbol"),toSymbolKeepAspect:v.getItemVisual(p,"symbolKeepAspect"),toSymbolOffset:v.getItemVisual(p,"symbolOffset"),toSymbolRotate:v.getItemVisual(p,"symbolRotate"),toSymbolSize:v.getItemVisual(p,"symbolSize"),toSymbol:v.getItemVisual(p,"symbol"),style:g})}),f.updateData(m),y.line.eachItemGraphicEl(function(p){Q(p).dataModel=e,p.traverse(function(g){Q(g).dataModel=e})});function I(p,g,k){var d=p.getItemModel(g);U(p,g,k,r,i);var A=d.getModel("itemStyle").getItemStyle();A.fill==null&&(A.fill=Ot(l,"color")),p.setItemVisual(g,{symbolKeepAspect:d.get("symbolKeepAspect"),symbolOffset:z(d.get("symbolOffset",!0),L[k?0:1]),symbolRotate:z(d.get("symbolRotate",!0),S[k?0:1]),symbolSize:z(d.get("symbolSize"),h[k?0:1]),symbol:z(d.get("symbol",!0),b[k?0:1]),style:A})}this.markKeep(f),f.group.silent=e.get("silent")||r.get("silent")},t.type="markLine",t}(ct);function Jt(a,t,r){var e;a?e=V(a&&a.dimensions,function(u){var f=t.getData().getDimensionInfo(t.getData().mapDimension(u))||{};return Y(Y({},f),{name:u,ordinalMeta:null})}):e=[{name:"value",type:"float"}];var o=new G(e,r),i=new G(e,r),n=new G([],r),s=V(r.get("data"),W(Qt,t,a,r));a&&(s=Vt(s,W(Wt,a)));var l=vt(!!a,e);return o.initData(V(s,function(u){return u[0]}),null,l),i.initData(V(s,function(u){return u[1]}),null,l),n.initData(V(s,function(u){return u[2]})),n.hasItemOption=!0,{from:o,to:i,line:n}}var Zt=qt;function ee(a){a.registerComponentModel(Xt),a.registerComponentView(Zt),a.registerPreprocessor(function(t){ht(t.series,"markLine")&&(t.markLine=t.markLine||{})})}export{ee as i};
