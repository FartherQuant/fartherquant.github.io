import{i as N,m as F,aF as pt,a$ as gt,a as M,ah as E,aq as yt,e as L,al as It,b0 as mt,p as St,S as xt,z as ut,y as j,b1 as lt,b2 as Dt,_ as W,a9 as et,aD as bt,b3 as Tt,b4 as wt,u as at,s as At,t as Mt,aE as Pt,b5 as Vt,af as Lt,Q as Rt,b6 as _t,b7 as Nt,C as Ct,M as kt,w as Et,L as k,b8 as Ot}from"./index.esm.min.52064240.js";import{d as Ht}from"./dataFilter.40908f6c.js";function rt(a,t,e){var r=a.get("borderRadius");if(r==null)return e?{cornerRadius:0}:null;N(r)||(r=[r,r,r,r]);var n=Math.abs(t.r||0-t.r0||0);return{cornerRadius:F(r,function(o){return pt(o,n)})}}var T=gt();function Ft(a){var t=a.mainData,e=a.datas;e||(e={main:t},a.datasAttr={main:"data"}),a.datas=a.mainData=null,ht(t,e,a),M(e,function(r){M(t.TRANSFERABLE_METHODS,function(n){r.wrapMethod(n,E(Bt,a))})}),t.wrapMethod("cloneShallow",E(Zt,a)),M(t.CHANGABLE_METHODS,function(r){t.wrapMethod(r,E(Ut,a))}),yt(e[t.dataType]===t)}function Bt(a,t){if(qt(this)){var e=L({},T(this).datas);e[this.dataType]=t,ht(t,e,a)}else X(t,this.dataType,T(this).mainData,a);return t}function Ut(a,t){return a.struct&&a.struct.update(),t}function Zt(a,t){return M(T(t).datas,function(e,r){e!==t&&X(e.cloneShallow(),r,t,a)}),t}function Gt(a){var t=T(this).mainData;return a==null||t==null?t:T(t).datas[a]}function $t(){var a=T(this).mainData;return a==null?[{data:a}]:F(It(T(a).datas),function(t){return{type:t,data:T(a).datas[t]}})}function qt(a){return T(a).mainData===a}function ht(a,t,e){T(a).datas={},M(t,function(r,n){X(r,n,a,e)})}function X(a,t,e,r){T(e).datas[t]=a,T(a).mainData=e,a.dataType=t,r.struct&&(a[r.structAttr]=r.struct,r.struct[r.datasAttr[t]]=a),a.getLinkedData=Gt,a.getLinkedDataAll=$t}var zt=function(){function a(t,e){this.depth=0,this.height=0,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.isExpand=!1,this.name=t||"",this.hostTree=e}return a.prototype.isRemoved=function(){return this.dataIndex<0},a.prototype.eachNode=function(t,e,r){ut(t)&&(r=e,e=t,t=null),t=t||{},j(t)&&(t={order:t});var n=t.order||"preorder",o=this[t.attr||"children"],i;n==="preorder"&&(i=e.call(r,this));for(var s=0;!i&&s<o.length;s++)o[s].eachNode(t,e,r);n==="postorder"&&e.call(r,this)},a.prototype.updateDepthAndHeight=function(t){var e=0;this.depth=t;for(var r=0;r<this.children.length;r++){var n=this.children[r];n.updateDepthAndHeight(t+1),n.height>e&&(e=n.height)}this.height=e+1},a.prototype.getNodeById=function(t){if(this.getId()===t)return this;for(var e=0,r=this.children,n=r.length;e<n;e++){var o=r[e].getNodeById(t);if(o)return o}},a.prototype.contains=function(t){if(t===this)return!0;for(var e=0,r=this.children,n=r.length;e<n;e++){var o=r[e].contains(t);if(o)return o}},a.prototype.getAncestors=function(t){for(var e=[],r=t?this:this.parentNode;r;)e.push(r),r=r.parentNode;return e.reverse(),e},a.prototype.getAncestorsIndices=function(){for(var t=[],e=this;e;)t.push(e.dataIndex),e=e.parentNode;return t.reverse(),t},a.prototype.getDescendantIndices=function(){var t=[];return this.eachNode(function(e){t.push(e.dataIndex)}),t},a.prototype.getValue=function(t){var e=this.hostTree.data;return e.getStore().get(e.getDimensionIndex(t||"value"),this.dataIndex)},a.prototype.setLayout=function(t,e){this.dataIndex>=0&&this.hostTree.data.setItemLayout(this.dataIndex,t,e)},a.prototype.getLayout=function(){return this.hostTree.data.getItemLayout(this.dataIndex)},a.prototype.getModel=function(t){if(!(this.dataIndex<0)){var e=this.hostTree,r=e.data.getItemModel(this.dataIndex);return r.getModel(t)}},a.prototype.getLevelModel=function(){return(this.hostTree.levelModels||[])[this.depth]},a.prototype.setVisual=function(t,e){this.dataIndex>=0&&this.hostTree.data.setItemVisual(this.dataIndex,t,e)},a.prototype.getVisual=function(t){return this.hostTree.data.getItemVisual(this.dataIndex,t)},a.prototype.getRawIndex=function(){return this.hostTree.data.getRawIndex(this.dataIndex)},a.prototype.getId=function(){return this.hostTree.data.getId(this.dataIndex)},a.prototype.getChildIndex=function(){if(this.parentNode){for(var t=this.parentNode.children,e=0;e<t.length;++e)if(t[e]===this)return e;return-1}return-1},a.prototype.isAncestorOf=function(t){for(var e=t.parentNode;e;){if(e===this)return!0;e=e.parentNode}return!1},a.prototype.isDescendantOf=function(t){return t!==this&&t.isAncestorOf(this)},a}(),jt=function(){function a(t){this.type="tree",this._nodes=[],this.hostModel=t}return a.prototype.eachNode=function(t,e,r){this.root.eachNode(t,e,r)},a.prototype.getNodeByDataIndex=function(t){var e=this.data.getRawIndex(t);return this._nodes[e]},a.prototype.getNodeById=function(t){return this.root.getNodeById(t)},a.prototype.update=function(){for(var t=this.data,e=this._nodes,r=0,n=e.length;r<n;r++)e[r].dataIndex=-1;for(var r=0,n=t.count();r<n;r++)e[t.getRawIndex(r)].dataIndex=r},a.prototype.clearLayouts=function(){this.data.clearItemLayouts()},a.createTree=function(t,e,r){var n=new a(e),o=[],i=1;s(t);function s(v,d){var p=v.value;i=Math.max(i,N(p)?p.length:1),o.push(v);var y=new zt(mt(v.name,""),n);d?Wt(y,d):n.root=y,n._nodes.push(y);var S=v.children;if(S)for(var x=0;x<S.length;x++)s(S[x],y)}n.root.updateDepthAndHeight(0);var l=St(o,{coordDimensions:["value"],dimensionsCount:i}).dimensions,c=new xt(l,e);return c.initData(o),r&&r(c),Ft({mainData:c,struct:n,structAttr:"tree"}),n.update(),n},a}();function Wt(a,t){var e=t.children;a.parentNode!==t&&(e.push(a),a.parentNode=t)}var Xt=jt;function nt(a,t,e){if(a&&lt(t,a.type)>=0){var r=e.getData().tree.root,n=a.targetNode;if(j(n)&&(n=r.getNodeById(n)),n&&r.contains(n))return{node:n};var o=a.targetNodeId;if(o!=null&&(n=r.getNodeById(o)))return{node:n}}}function Yt(a){for(var t=[];a;)a=a.parentNode,a&&t.push(a);return t.reverse()}function Jt(a,t){var e=Yt(a);return lt(e,t)>=0}function Kt(a,t){for(var e=[];a;){var r=a.dataIndex;e.push({name:a.name,dataIndex:r,value:t.getRawValue(r)}),a=a.parentNode}return e.reverse(),e}function Qt(a){var t=a.getData(),e=t.tree,r={};e.eachNode(function(n){for(var o=n;o&&o.depth>1;)o=o.parentNode;var i=Dt(a.ecModel,o.name||o.dataIndex+"",r);n.setVisual("decal",i)})}var te=2,ee=4,ae=function(a){W(t,a);function t(e,r,n,o){var i=a.call(this)||this;i.z2=te,i.textConfig={inside:!0},et(i).seriesIndex=r.seriesIndex;var s=new bt({z2:ee,silent:e.getModel().get(["label","silent"])});return i.setTextContent(s),i.updateData(!0,e,r,n,o),i}return t.prototype.updateData=function(e,r,n,o,i){this.node=r,r.piece=this,n=n||this._seriesModel,o=o||this._ecModel;var s=this;et(s).dataIndex=r.dataIndex;var l=r.getModel(),c=l.getModel("emphasis"),v=r.getLayout(),d=L({},v);d.label=null;var p=r.getVisual("style");p.lineJoin="bevel";var y=r.getVisual("decal");y&&(p.decal=Tt(y,i));var S=rt(l.getModel("itemStyle"),d,!0);L(d,S),M(wt,function(u){var h=s.ensureState(u),f=l.getModel([u,"itemStyle"]);h.style=f.getItemStyle();var m=rt(f,d);m&&(h.shape=m)}),e?(s.setShape(d),s.shape.r=v.r0,at(s,{shape:{r:v.r}},n,r.dataIndex)):(at(s,{shape:d},n),At(s)),s.useStyle(p),this._updateLabel(n);var x=l.getShallow("cursor");x&&s.attr("cursor",x),this._seriesModel=n||this._seriesModel,this._ecModel=o||this._ecModel;var g=c.get("focus"),I=g==="ancestor"?r.getAncestorsIndices():g==="descendant"?r.getDescendantIndices():g;Mt(this,I,c.get("blurScope"),c.get("disabled"))},t.prototype._updateLabel=function(e){var r=this,n=this.node.getModel(),o=n.getModel("label"),i=this.node.getLayout(),s=i.endAngle-i.startAngle,l=(i.startAngle+i.endAngle)/2,c=Math.cos(l),v=Math.sin(l),d=this,p=d.getTextContent(),y=this.node.dataIndex,S=o.get("minAngle")/180*Math.PI,x=o.get("show")&&!(S!=null&&Math.abs(s)<S);p.ignore=!x,M(Vt,function(I){var u=I==="normal"?n.getModel("label"):n.getModel([I,"label"]),h=I==="normal",f=h?p:p.ensureState(I),m=e.getFormattedLabel(y,I);h&&(m=m||r.node.name),f.style=Pt(u,{},null,I!=="normal",!0),m&&(f.style.text=m);var w=u.get("show");w!=null&&!h&&(f.ignore=!w);var R=g(u,"position"),V=h?d:d.states[I],_=V.style.fill;V.textConfig={outsideFill:u.get("color")==="inherit"?_:null,inside:R!=="outside"};var P,O=g(u,"distance")||0,D=g(u,"align");R==="outside"?(P=i.r+O,D=l>Math.PI/2?"right":"left"):!D||D==="center"?(s===2*Math.PI&&i.r0===0?P=0:P=(i.r+i.r0)/2,D="center"):D==="left"?(P=i.r0+O,l>Math.PI/2&&(D="right")):D==="right"&&(P=i.r-O,l>Math.PI/2&&(D="left")),f.style.align=D,f.style.verticalAlign=g(u,"verticalAlign")||"middle",f.x=P*c+i.cx,f.y=P*v+i.cy;var C=g(u,"rotate"),b=0;C==="radial"?(b=-l,b<-Math.PI/2&&(b+=Math.PI)):C==="tangential"?(b=Math.PI/2-l,b>Math.PI/2?b-=Math.PI:b<-Math.PI/2&&(b+=Math.PI)):Rt(C)&&(b=C*Math.PI/180),f.rotation=b});function g(I,u){var h=I.get(u);return h==null?o.get(u):h}p.dirtyStyle()},t}(Lt),it=ae,z="sunburstRootToNode",ot="sunburstHighlight",re="sunburstUnhighlight";function ne(a){a.registerAction({type:z,update:"updateView"},function(t,e){e.eachComponent({mainType:"series",subType:"sunburst",query:t},r);function r(n,o){var i=nt(t,[z],n);if(i){var s=n.getViewRoot();s&&(t.direction=Jt(s,i.node)?"rollUp":"drillDown"),n.resetViewRoot(i.node)}}}),a.registerAction({type:ot,update:"none"},function(t,e,r){t=L({},t),e.eachComponent({mainType:"series",subType:"sunburst",query:t},n);function n(o){var i=nt(t,[ot],o);i&&(t.dataIndex=i.node.dataIndex)}r.dispatchAction(L(t,{type:"highlight"}))}),a.registerAction({type:re,update:"updateView"},function(t,e,r){t=L({},t),r.dispatchAction(L(t,{type:"downplay"}))})}var ie=function(a){W(t,a);function t(){var e=a!==null&&a.apply(this,arguments)||this;return e.type=t.type,e}return t.prototype.render=function(e,r,n,o){var i=this;this.seriesModel=e,this.api=n,this.ecModel=r;var s=e.getData(),l=s.tree.root,c=e.getViewRoot(),v=this.group,d=e.get("renderLabelForZeroData"),p=[];c.eachNode(function(u){p.push(u)});var y=this._oldChildren||[];S(p,y),I(l,c),this._initEvents(),this._oldChildren=p;function S(u,h){if(u.length===0&&h.length===0)return;new _t(h,u,f,f).add(m).update(m).remove(E(m,null)).execute();function f(w){return w.getId()}function m(w,R){var V=w==null?null:u[w],_=R==null?null:h[R];x(V,_)}}function x(u,h){if(!d&&u&&!u.getValue()&&(u=null),u!==l&&h!==l){if(h&&h.piece)u?(h.piece.updateData(!1,u,e,r,n),s.setItemGraphicEl(u.dataIndex,h.piece)):g(h);else if(u){var f=new it(u,e,r,n);v.add(f),s.setItemGraphicEl(u.dataIndex,f)}}}function g(u){!u||u.piece&&(v.remove(u.piece),u.piece=null)}function I(u,h){h.depth>0?(i.virtualPiece?i.virtualPiece.updateData(!1,u,e,r,n):(i.virtualPiece=new it(u,e,r,n),v.add(i.virtualPiece)),h.piece.off("click"),i.virtualPiece.on("click",function(f){i._rootToNode(h.parentNode)})):i.virtualPiece&&(v.remove(i.virtualPiece),i.virtualPiece=null)}},t.prototype._initEvents=function(){var e=this;this.group.off("click"),this.group.on("click",function(r){var n=!1,o=e.seriesModel.getViewRoot();o.eachNode(function(i){if(!n&&i.piece&&i.piece===r.target){var s=i.getModel().get("nodeClick");if(s==="rootToNode")e._rootToNode(i);else if(s==="link"){var l=i.getModel(),c=l.get("link");if(c){var v=l.get("target",!0)||"_blank";Nt(c,v)}}n=!0}})})},t.prototype._rootToNode=function(e){e!==this.seriesModel.getViewRoot()&&this.api.dispatchAction({type:z,from:this.uid,seriesId:this.seriesModel.id,targetNode:e})},t.prototype.containPoint=function(e,r){var n=r.getData(),o=n.getItemLayout(0);if(o){var i=e[0]-o.cx,s=e[1]-o.cy,l=Math.sqrt(i*i+s*s);return l<=o.r&&l>=o.r0}},t.type="sunburst",t}(Ct),oe=ie,se=function(a){W(t,a);function t(){var e=a!==null&&a.apply(this,arguments)||this;return e.type=t.type,e.ignoreStyleOnData=!0,e}return t.prototype.getInitialData=function(e,r){var n={name:e.name,children:e.data};ct(n);var o=this._levelModels=F(e.levels||[],function(l){return new kt(l,this,r)},this),i=Xt.createTree(n,this,s);function s(l){l.wrapMethod("getItemModel",function(c,v){var d=i.getNodeByDataIndex(v),p=o[d.depth];return p&&(c.parentModel=p),c})}return i.data},t.prototype.optionUpdated=function(){this.resetViewRoot()},t.prototype.getDataParams=function(e){var r=a.prototype.getDataParams.apply(this,arguments),n=this.getData().tree.getNodeByDataIndex(e);return r.treePathInfo=Kt(n,this),r},t.prototype.getLevelModel=function(e){return this._levelModels&&this._levelModels[e.depth]},t.prototype.getViewRoot=function(){return this._viewRoot},t.prototype.resetViewRoot=function(e){e?this._viewRoot=e:e=this._viewRoot;var r=this.getRawData().tree.root;(!e||e!==r&&!r.contains(e))&&(this._viewRoot=r)},t.prototype.enableAriaDecal=function(){Qt(this)},t.type="series.sunburst",t.defaultOption={z:2,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,stillShowZeroSum:!0,nodeClick:"rootToNode",renderLabelForZeroData:!1,label:{rotate:"radial",show:!0,opacity:1,align:"center",position:"inside",distance:5,silent:!0},itemStyle:{borderWidth:1,borderColor:"white",borderType:"solid",shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,opacity:1},emphasis:{focus:"descendant"},blur:{itemStyle:{opacity:.2},label:{opacity:.1}},animationType:"expansion",animationDuration:1e3,animationDurationUpdate:500,data:[],sort:"desc"},t}(Et);function ct(a){var t=0;M(a.children,function(r){ct(r);var n=r.value;N(n)&&(n=n[0]),t+=n});var e=a.value;N(e)&&(e=e[0]),(e==null||isNaN(e))&&(e=t),e<0&&(e=0),N(a.value)?a.value[0]=e:a.value=e}var ue=se,st=Math.PI/180;function le(a,t,e){t.eachSeriesByType(a,function(r){var n=r.get("center"),o=r.get("radius");N(o)||(o=[0,o]),N(n)||(n=[n,n]);var i=e.getWidth(),s=e.getHeight(),l=Math.min(i,s),c=k(n[0],i),v=k(n[1],s),d=k(o[0],l/2),p=k(o[1],l/2),y=-r.get("startAngle")*st,S=r.get("minAngle")*st,x=r.getData().tree.root,g=r.getViewRoot(),I=g.depth,u=r.get("sort");u!=null&&dt(g,u);var h=0;M(g.children,function(A){!isNaN(A.getValue())&&h++});var f=g.getValue(),m=Math.PI/(f||h)*2,w=g.depth>0,R=g.height-(w?-1:1),V=(p-d)/(R||1),_=r.get("clockwise"),P=r.get("stillShowZeroSum"),O=_?1:-1,D=function(A,H){if(!!A){var Z=H;if(A!==x){var vt=A.getValue(),B=f===0&&P?m:vt*m;B<S&&(B=S),Z=H+O*B;var J=A.depth-I-(w?-1:1),K=d+V*J,Q=d+V*(J+1),U=r.getLevelModel(A);if(U){var G=U.get("r0",!0),$=U.get("r",!0),q=U.get("radius",!0);q!=null&&(G=q[0],$=q[1]),G!=null&&(K=k(G,l/2)),$!=null&&(Q=k($,l/2))}A.setLayout({angle:B,startAngle:H,endAngle:Z,clockwise:_,cx:c,cy:v,r0:K,r:Q})}if(A.children&&A.children.length){var tt=0;M(A.children,function(ft){tt+=D(ft,H+tt)})}return Z-H}};if(w){var C=d,b=d+V,Y=Math.PI*2;x.setLayout({angle:Y,startAngle:y,endAngle:y+Y,clockwise:_,cx:c,cy:v,r0:C,r:b})}D(g,y)})}function dt(a,t){var e=a.children||[];a.children=he(e,t),e.length&&M(a.children,function(r){dt(r,t)})}function he(a,t){if(ut(t)){var e=F(a,function(n,o){var i=n.getValue();return{params:{depth:n.depth,height:n.height,dataIndex:n.dataIndex,getValue:function(){return i}},index:o}});return e.sort(function(n,o){return t(n.params,o.params)}),F(e,function(n){return a[n.index]})}else{var r=t==="asc";return a.sort(function(n,o){var i=(n.getValue()-o.getValue())*(r?1:-1);return i===0?(n.dataIndex-o.dataIndex)*(r?-1:1):i})}}function ce(a){var t={};function e(r,n,o){for(var i=r;i&&i.depth>1;)i=i.parentNode;var s=n.getColorFromPalette(i.name||i.dataIndex+"",t);return r.depth>1&&j(s)&&(s=Ot(s,(r.depth-1)/(o-1)*.5)),s}a.eachSeriesByType("sunburst",function(r){var n=r.getData(),o=n.tree;o.eachNode(function(i){var s=i.getModel(),l=s.getModel("itemStyle").getItemStyle();l.fill||(l.fill=e(i,r,o.root.height));var c=n.ensureUniqueItemVisual(i.dataIndex,"style");L(c,l)})})}function fe(a){a.registerChartView(oe),a.registerSeriesModel(ue),a.registerLayout(E(le,"sunburst")),a.registerProcessor(E(Ht,"sunburst")),a.registerVisual(ce),ne(a)}export{fe as i};
